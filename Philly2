-- Services
local Players = game:GetService("Players")
local Workspace = game:GetService("Workspace")
local RunService = game:GetService("RunService")

-- Variables
local LocalPlayer = Players.LocalPlayer
local Character = LocalPlayer.Character or LocalPlayer.CharacterAdded:Wait()
local HumanoidRootPart = Character:WaitForChild("HumanoidRootPart")

-- Find the "prompt" object using your corrected path.
local prompt = Workspace:WaitForChild("WashingMachine"):WaitForChild("Interaction"):WaitForChild("prompt")
if not prompt then
    warn("The 'prompt' object was not found. Please check the hierarchy again.")
end

-- Coordinates for the fast movement
local pointA = Vector3.new(2454.063720703125, 285.8049621532031, -1341.2506103515626)
local pointB = Vector3.new(2473.269775390625, 285.8037414550781, -1341.27783203125)

-- UI Creation
local playerGui = LocalPlayer:WaitForChild("PlayerGui")
local screenGui = Instance.new("ScreenGui")
screenGui.Name = "AutoMoveUI"
screenGui.Parent = playerGui

local frame = Instance.new("Frame")
frame.Size = UDim2.new(0, 200, 0, 80)
frame.Position = UDim2.new(0.5, -100, 0.5, -40)
frame.BackgroundColor3 = Color3.fromRGB(40, 40, 40)
frame.BorderColor3 = Color3.fromRGB(20, 20, 20)
frame.Draggable = true
frame.Parent = screenGui

local title = Instance.new("TextLabel")
title.Text = "Super Speed"
title.Size = UDim2.new(1, 0, 0, 25)
title.Position = UDim2.new(0, 0, 0, 0)
title.BackgroundColor3 = Color3.fromRGB(50, 50, 50)
title.TextColor3 = Color3.new(1, 1, 1)
title.Parent = frame

local toggleButton = Instance.new("TextButton")
toggleButton.Name = "ToggleButton"
toggleButton.Text = "START"
toggleButton.Size = UDim2.new(0.9, 0, 0, 40)
toggleButton.Position = UDim2.new(0.05, 0, 0.4, 0)
toggleButton.BackgroundColor3 = Color3.fromRGB(50, 150, 50)
toggleButton.TextColor3 = Color3.new(1, 1, 1)
toggleButton.Parent = frame

-- Movement variables
local isRunning = false
local currentTarget = "B"
local teleportSpeed = 850
local teleportDistance = 0.05
local moveCounter = 0 -- NEW: Counter for back-and-forth movements
local maxCycles = 10 -- NEW: How many times to go back and forth

local connection = nil

local function onRenderStep(deltaTime)
    if isRunning then
        local targetPosition
        if currentTarget == "A" then
            targetPosition = pointA
        else
            targetPosition = pointB
        end

        local currentPosition = HumanoidRootPart.Position
        local direction = (targetPosition - currentPosition)
        local distance = direction.Magnitude
        local normalizedDirection = direction.Unit
        
        -- Check if we're close enough to switch points
        if distance < teleportDistance * 2 then
            -- NEW: If we just finished a full cycle (from B to A), increment the counter
            if currentTarget == "A" then
                moveCounter = moveCounter + 1
            end
            
            -- Switch targets
            currentTarget = (currentTarget == "A") and "B" or "A"
            HumanoidRootPart.CFrame = CFrame.new(targetPosition)

            -- NEW: Check if the cycle count has been reached
            if moveCounter >= maxCycles then
                -- Generate a random location
                local randomX = math.random(-5000, 5000)
                local randomY = 200 -- Keep a consistent height to avoid falling
                local randomZ = math.random(-5000, 5000)
                local newCFrame = CFrame.new(randomX, randomY, randomZ)
                
                -- Teleport the character instantly
                HumanoidRootPart.CFrame = newCFrame

                -- Reset script state and stop movement
                moveCounter = 0
                isRunning = false
                toggleButton.Text = "START"
                toggleButton.BackgroundColor3 = Color3.fromRGB(50, 150, 50)
                
                -- Stop the RunService loop
                if connection then
                    connection:Disconnect()
                    connection = nil
                end
                
                -- Also make sure to stop the HoldInput action
                if prompt then
                    prompt:HoldInputEnd()
                end
                
                return -- Exit the function early to prevent further movement
            end
        else
            local moveVector = normalizedDirection * teleportDistance * teleportSpeed * deltaTime
            HumanoidRootPart.CFrame = HumanoidRootPart.CFrame + moveVector
            
            -- Rotate the character to face the direction of movement
            local lookAtCFrame = CFrame.lookAt(HumanoidRootPart.Position, HumanoidRootPart.Position + normalizedDirection)
            HumanoidRootPart.CFrame = CFrame.new(HumanoidRootPart.CFrame.Position) * lookAtCFrame.Rotation
        end

        -- Call the HoldInputBegin function repeatedly
        if prompt then
            prompt:HoldInputBegin()
        end
    end
end

toggleButton.MouseButton1Click:Connect(function()
    isRunning = not isRunning
    if isRunning then
        toggleButton.Text = "STOP"
        toggleButton.BackgroundColor3 = Color3.fromRGB(150, 50, 50)
        
        HumanoidRootPart.CFrame = CFrame.new(pointA)
        connection = RunService.RenderStepped:Connect(onRenderStep)
    else
        toggleButton.Text = "START"
        toggleButton.BackgroundColor3 = Color3.fromRGB(50, 150, 50)
        
        -- Stop the HoldInput action when the script is turned off
        if prompt then
            prompt:HoldInputEnd()
        end
        
        if connection then
            connection:Disconnect()
            connection = nil
        end
    end
end)

print("Super Speed script loaded successfully.")
