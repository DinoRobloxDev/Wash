-- Services
local Players = game:GetService("Players")
local Workspace = game:GetService("Workspace")
local RunService = game:GetService("RunService")
local UserInputService = game:GetService("UserInputService")
local ReplicatedStorage = game:GetService("ReplicatedStorage")

-- UI Library
local DiscordLib = loadstring(game:HttpGet("https://raw.githubusercontent.com/dawid-scripts/UI-Libs/main/discord%20lib.txt"))()

-- Universal Functions
local LocalPlayer = Players.LocalPlayer
local Character = LocalPlayer.Character or LocalPlayer.CharacterAdded:Wait()
local Humanoid = Character:WaitForChild("Humanoid")
local HumanoidRootPart = Character:WaitForChild("HumanoidRootPart")
local Camera = Workspace.CurrentCamera

-- The RemoteEvent you found. This must be the correct path.
local promptRemoteEvent = ReplicatedStorage:FindFirstChild("interactionFunction")

-- UI Creation
local win = DiscordLib:Window("Instant Wash")
local moneyServer = win:Server("Money", "")
local moneyChannel = moneyServer:Channel("Automation")

local prompts = {}
local originalDistances = {}

-- A function to find and store the prompts based on the provided hierarchy.
local function findWashers()
    prompts = {}
    for _, descendant in ipairs(Workspace:GetDescendants()) do
        if descendant and descendant:IsA("ProximityPrompt") then
            local parent = descendant.Parent
            local grandparent = parent and parent.Parent
            if parent and parent.Name == "Interaction" and grandparent and grandparent.Name == "WashingMachine" then
                table.insert(prompts, descendant)
                originalDistances[descendant] = descendant.MaxActivationDistance
            end
        end
    end
end

-- Toggle to make prompts visible
moneyChannel:Toggle("Show Prompts", false, function(value)
    if #prompts == 0 then
        findWashers()
    end
    
    if #prompts > 0 then
        for _, prompt in ipairs(prompts) do
            if value then
                prompt.MaxActivationDistance = math.huge
            else
                prompt.MaxActivationDistance = originalDistances[prompt] or 10
            end
        end
        DiscordLib:Notification("Success", "Prompt visibility toggled!", "Okay!")
    else
        DiscordLib:Notification("Error", "No washing machine prompts found.", "Okay!")
    end
end)

moneyChannel:Button("Instant Wash", function()
    if #prompts == 0 then
        findWashers()
    end
    
    if not promptRemoteEvent then
        DiscordLib:Notification("Error", "Interaction remote not found!", "Okay!")
        return
    end
    
    if #prompts > 0 then
        local foundPrompts = {}
        for _, prompt in ipairs(prompts) do
            if (HumanoidRootPart.Position - prompt.Parent.Position).Magnitude <= 200 then
                table.insert(foundPrompts, prompt)
            end
        end
        
        if #foundPrompts > 0 then
            for _, prompt in ipairs(foundPrompts) do
                promptRemoteEvent:FireServer(prompt)
            end
            DiscordLib:Notification("Success", "Interacted with " .. #foundPrompts .. " prompts!", "Okay!")
        else
            DiscordLib:Notification("Error", "No prompts found within 200 studs.", "Okay!")
        end
    else
        DiscordLib:Notification("Error", "No washing machine prompts found.", "Okay!")
    end
end)

print("Instant Wash script loaded successfully.")
